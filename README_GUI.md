# 身份证号码识别与文件重命名工具 (GUI版)

这是一个带有图形用户界面的批量处理PDF或图片文件，识别其中的中国大陆身份证号码并将文件重命名为识别到的身份证号码的工具。

## 功能特点

- 用户友好的图形界面，无需命令行操作
- 实时显示处理进度和结果
- 支持PDF文件和常见图片格式(JPG, PNG, TIFF, BMP)
- 自动处理PDF文本和图像识别
- 支持单个文件或批量处理整个目录
- 可选择递归处理子目录
- 使用正则表达式准确匹配身份证号码格式
- **关键字搜索**：可以指定关键字，提高识别准确率
- **区域选择**：可以指定图像中的特定区域进行识别，减少干扰

## 安装依赖

```bash
pip install -r requirements.txt
```

另外，本程序依赖Tesseract OCR引擎，需要单独安装：

### Windows安装Tesseract

1. 从[此处](https://github.com/UB-Mannheim/tesseract/wiki)下载并安装Tesseract
2. 确保安装中文语言包（chi_sim）
3. 默认安装路径通常是`C:\Program Files\Tesseract-OCR\tesseract.exe`

### Linux安装Tesseract

```bash
sudo apt update
sudo apt install tesseract-ocr
sudo apt install tesseract-ocr-chi-sim
```

### macOS安装Tesseract

```bash
brew install tesseract
brew install tesseract-lang
```

## 使用方法

运行GUI程序：

```bash
python id_card_extractor_gui.py
```

程序界面包含以下主要部分：

1. **Tesseract设置**：
   
   - 配置Tesseract OCR引擎的路径
   - 使用"测试"按钮验证Tesseract安装是否正确

2. **输入设置**：
   
   - 选择文件：处理单个PDF或图像文件
   - 选择文件夹：批量处理文件夹中的所有PDF和图像文件
   - 递归处理子目录：勾选后将处理所选文件夹及其所有子文件夹

3. **高级设置**：
   
   - **关键字搜索**：启用后，只处理包含指定关键字的文件
   - **区域选择**：启用后，只识别图像中指定区域的内容
   - 选择示例图片：选择一张示例图片来定义识别区域
   - 定义识别区域：在示例图片上框选要识别的区域

4. **操作按钮**：
   
   - 开始处理：开始执行识别和重命名操作
   - 停止：中断正在进行的处理

5. **进度显示**：
   
   - 进度条和计数器显示处理进度
   - 日志窗口显示处理过程的详细信息

## 处理流程

1. 配置Tesseract路径并验证安装
2. 选择要处理的文件或文件夹
3. 点击"开始处理"
4. 在日志窗口中查看处理过程和结果
5. 处理完成后，会显示成功和失败的文件数量

## 注意事项

1. 识别结果取决于OCR质量，请确保图像清晰度
2. 如果文件已经以正确的身份证号码命名，将保持不变
3. 如果目标文件名已存在，将不会进行重命名操作
4. 程序会自动忽略不支持的文件类型

## 故障排除

如果遇到问题：

1. 确保正确安装了Tesseract OCR和中文语言包
2. 使用"测试"按钮验证Tesseract安装
3. 检查日志窗口中的错误信息
4. 对于特别大的文件或大量文件，处理可能需要较长时间

## 高级功能使用说明

### 关键字搜索

关键字搜索功能可以帮助过滤文档和提高识别准确率：

1. 勾选"使用关键字搜索"选项
2. 在关键字输入框中输入关键字，用逗号分隔（例如：身份证,号码,姓名,性别,民族）
3. 程序会优先处理包含这些关键字的文件，并在日志中显示匹配情况
4. 对于未找到关键字的文件，程序会降低优先级或跳过处理

常用关键字示例：
- 身份证
- 号码
- 姓名
- 性别
- 民族
- 出生
- 住址
- 公民身份号码

### 区域选择

区域选择功能可以帮助您只识别文档中包含身份证号码的特定区域，减少干扰：

1. 勾选"使用区域选择"选项
2. 点击"选择示例图片"按钮选择一张具有代表性的图片
3. 点击"定义识别区域"按钮
4. 在打开的窗口中，用鼠标拖拽选择包含身份证号码的区域
5. 点击"确认选择"按钮保存区域设置
6. 程序会在所有图像或PDF的相同位置进行识别

**注意事项**：
- 区域选择最适合处理格式统一的文档
- 对于不同尺寸的图像，程序会尝试按比例应用选定区域
- 如果处理的文档布局差异很大，不建议使用区域选择功能

## 常见问题

1. **识别效果不理想怎么办？**
   - 尝试使用关键字搜索，增加相关关键字
   - 使用区域选择功能，只识别包含身份证号码的区域
   - 确保图像清晰度足够，可以预先对图像进行处理提高对比度
   
2. **如何处理格式不统一的文档？**
   - 对于格式统一的文档，可以使用区域选择功能
   - 对于格式不统一的文档，建议使用关键字搜索功能
   - 或者关闭高级功能，使用默认全文识别 